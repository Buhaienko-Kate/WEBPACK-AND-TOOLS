(()=>{"use strict";const t=[{text:"Buy milk",done:!1,id:1},{text:"Pick up Tom from airport",done:!1,id:2},{text:"Visit party",done:!1,id:3},{text:"Visit doctor",done:!0,id:4},{text:"Buy meat",done:!0,id:5}],e=(t,e)=>{localStorage.setItem(t,JSON.stringify(e))},s=s=>(null===localStorage.getItem(s)&&e("tasksList",t),JSON.parse(localStorage.getItem(s))),n="https://614086504a700c0017b0cd68.mockapi.io/api/v1/tasks",i=()=>fetch(n).then((t=>t.json())),a=document.querySelector(".task-input"),d=document.querySelector(".list"),o=({text:t,done:e,id:s})=>{const n=document.createElement("li");n.classList.add("list__item"),e&&n.classList.add("list__item_done");const i=((t,e)=>{const s=document.createElement("input");return s.setAttribute("type","checkbox"),s.checked=t,s.classList.add("list__item-checkbox"),s.dataset.id=e,s})(e,s),a=document.createElement("span");a.classList.add("list__item-text"),a.textContent=t;const d=document.createElement("button");return d.classList.add("list__item-delete-btn"),n.append(i,a,d),n},c=(t,e)=>t.done-e.done,r=()=>{const t=s("tasksList")||[];d.innerHTML="";const e=t.sort(c).map(o);d.append(...e)};document.addEventListener("DOMContentLoaded",(()=>{i().then((t=>{e("tasksList",t),r()}))})),document.querySelector(".create-task-btn").addEventListener("click",(()=>{const t=a.value;var s;""!==t&&(a.value="",d.innerHTML="",(s={text:t,done:!1},fetch(n,{method:"POST",headers:{"Content-type":"application/json;charset=utf-8"},body:JSON.stringify(s)})).then((()=>i())).then((t=>{e("tasksList",t),r()})))})),d.addEventListener("click",(t=>{if(!t.target.classList.contains("list__item-checkbox"))return;const a=t.target,d=s("tasksList"),o=a.dataset.id,{text:c}=d.find((t=>t.id===o)),l={text:c,done:a.checked};((t,e)=>fetch(`${n}/${t}`,{method:"PUT",headers:{"Content-type":"application/json;charset=utf-8"},body:JSON.stringify(e)}))(o,l).then((()=>i())).then((t=>{e("tasksList",t),r()}))})),d.addEventListener("click",(function(t){if(!t.target.classList.contains("list__item-delete-btn"))return;var s;(s=t.target.parentNode.firstElementChild.dataset.id,fetch(`${n}/${s}`,{method:"DELETE"})).then((()=>i())).then((t=>{e("tasksList",t),r()}))})),window.addEventListener("storage",(t=>{"tasksList"===t.key&&r(),e("tasksList",s("tasksList"))}))})();